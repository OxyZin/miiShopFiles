<!DOCTYPE html>
<html>
<head>
    <title>miiShopFiles - FTP Browser</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #008080;
            margin: 0;
            padding: 0;
            color: #000;
        }
        .container {
            width: 800px;
            margin: 20px auto;
            background: #c0c0c0;
            border: 3px solid #000;
            box-shadow: 5px 5px 0 #333;
        }
        .header {
            background: #000080;
            color: white;
            padding: 5px 10px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }
        .warning {
            background: #ffff00;
            color: #000;
            padding: 10px;
            margin: 10px;
            border: 2px dotted #000;
            font-weight: bold;
        }
        .file-browser {
            margin: 10px;
        }
        .address-bar {
            background: white;
            padding: 3px;
            margin-bottom: 10px;
            border: 2px inset;
        }
        .toolbar {
            background: #c0c0c0;
            padding: 3px;
            border-bottom: 2px solid #808080;
            border-right: 2px solid #808080;
            border-left: 2px solid #fff;
            border-top: 2px solid #fff;
        }
        .file-list {
            background: white;
            border: 2px inset;
            min-height: 300px;
        }
        .file-item {
            display: flex;
            padding: 2px 5px;
            cursor: pointer;
        }
        .file-item:hover {
            background: #000080;
            color: white;
        }
        .file-icon {
            width: 20px;
            text-align: center;
            margin-right: 5px;
        }
        .file-name {
            flex: 1;
        }
        .file-size {
            width: 100px;
            text-align: right;
        }
        .file-date {
            width: 150px;
            text-align: right;
        }
        .status-bar {
            background: #c0c0c0;
            padding: 3px;
            border-top: 2px solid #808080;
            border-left: 2px solid #808080;
            border-right: 2px solid #fff;
            border-bottom: 2px solid #fff;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <span>miiShopFiles FTP</span>
            <span>X</span>
        </div>
        
        <div class="toolbar">
            <button>File</button>
            <button>Edit</button>
            <button>View</button>
            <button>Help</button>
        </div>
        
        <div class="address-bar">
            Address: ftp://github.com/OxyZin/miiShopFiles
        </div>
        
        <div id="warning-message" class="warning" style="display: none;">
            <!-- Message will load here if msg.txt exists -->
        </div>
        
        <div class="file-browser">
            <div class="file-list-header file-item">
                <div class="file-icon"></div>
                <div class="file-name">Name</div>
                <div class="file-size">Size</div>
                <div class="file-date">Modified</div>
            </div>
            <div class="file-list" id="file-list">
                <div class="file-item">
                    <div class="file-name">Loading...</div>
                </div>
            </div>
        </div>
        
        <div class="status-bar">
            <span id="status">Ready</span>
        </div>
    </div>

    <script>
        // Configuration
        const GITHUB_USER = "OxyZin";
        const GITHUB_REPO = "miiShopFiles";
        const BRANCH = "main";
        
        // Check for message (optional)
        checkForMessage();
        
        // Load file list
        loadFileList();
        
        function checkForMessage() {
            fetch(`https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/msg.txt`)
                .then(response => {
                    if (response.ok) return response.text();
                    throw new Error('File not found');
                })
                .then(text => {
                    const warningDiv = document.getElementById('warning-message');
                    warningDiv.innerHTML = text;
                    warningDiv.style.display = 'block';
                })
                .catch(error => {
                    console.log('No message file found - continuing normally');
                });
        }
        
        function loadFileList() {
            document.getElementById('status').textContent = 'Connecting to server...';
            
            fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/`)
                .then(response => response.json())
                .then(data => {
                    const fileList = document.getElementById('file-list');
                    fileList.innerHTML = '';
                    
                    // Sort: folders first
                    data.sort((a, b) => {
                        if (a.type === b.type) return a.name.localeCompare(b.name);
                        return a.type === 'dir' ? -1 : 1;
                    });
                    
                    data.forEach(item => {
                        const fileItem = document.createElement('div');
                        fileItem.className = 'file-item';
                        
                        const fileIcon = document.createElement('div');
                        fileIcon.className = 'file-icon';
                        fileIcon.innerHTML = item.type === 'dir' ? 'ðŸ“' : 'ðŸ“„';
                        
                        const fileName = document.createElement('div');
                        fileName.className = 'file-name';
                        fileName.textContent = item.name;
                        
                        const fileSize = document.createElement('div');
                        fileSize.className = 'file-size';
                        fileSize.textContent = item.type === 'dir' ? '' : formatFileSize(item.size);
                        
                        const fileDate = document.createElement('div');
                        fileDate.className = 'file-date';
                        fileDate.textContent = formatDate(new Date()); // GitHub doesn't provide modified date in this API
                        
                        const fileLink = document.createElement('a');
                        fileLink.href = `http://raw.githack.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/${item.path}`;
                        fileLink.style.display = 'none';
                        
                        fileItem.appendChild(fileIcon);
                        fileItem.appendChild(fileName);
                        fileItem.appendChild(fileSize);
                        fileItem.appendChild(fileDate);
                        fileItem.appendChild(fileLink);
                        
                        fileItem.addEventListener('click', () => {
                            if (item.type === 'dir') {
                                // For folders: could implement navigation here
                                alert('Folder navigation would go here in a full implementation');
                            } else {
                                // For files: open download link
                                window.open(fileLink.href, '_blank');
                            }
                        });
                        
                        fileList.appendChild(fileItem);
                    });
                    
                    document.getElementById('status').textContent = `${data.length} items`;
                })
                .catch(error => {
                    document.getElementById('file-list').innerHTML = 
                        '<div class="file-item"><div class="file-name">Error loading files</div></div>';
                    document.getElementById('status').textContent = 'Connection error';
                });
        }
        
        function formatFileSize(bytes) {
            if (!bytes) return '';
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / 1048576).toFixed(1) + ' MB';
        }
        
        function formatDate(date) {
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }
    </script>
</body>
</html>
